/* See license.txt for terms of usage */


define(["../domplate/domplate","../core/lib","i18n!../nls/search","../domplate/toolbar","../domplate/popupMenu","../core/cookies","../core/dragdrop"],function(e,t,n,s,i,o,a){var r=e.domplate,c=e.INPUT,h=e.SPAN,u={};return u.caseSensitiveCookieName="searchCaseSensitive",u.Box=r({tag:h({class:"searchBox"},h({class:"toolbarSeparator resizer"},"&nbsp;"),h({class:"searchTextBox"},c({class:"searchInput",type:"text",placeholder:n.search,onkeydown:"$onKeyDown"}),h({class:"arrow",onclick:"$onOpenOptions"},"&nbsp;"))),onKeyDown:function(e){var n=$.event.fix(e||window.event),s=t.getAncestorByClass(n.target,"tabBody"),i=t.getElementByClass(s,"searchInput");setTimeout(t.bindFixed(this.search,this,s,n.keyCode,i.value))},initialize:function(e){var n=t.getElementByClass(e,"searchInput"),s=t.getElementByClass(e,"resizer");u.Resizer.initialize(n,s)},search:function(e,n,s){var i=t.getElementByClass(e,"searchInput");i.removeAttribute("status");var o=i.value;if(!(o===s&&13!==n||13!==n&&t.isWebkit)){e.repObject.onSearch(o,n)||i.setAttribute("status","notfound")}},onOpenOptions:function(e){var n=t.fixEvent(e);if(t.cancelEvent(e),t.isLeftClick(e)){var s=n.target,o=this.getMenuItems(s);new i({id:"searchOptions",items:o}).showPopup(s)}},getMenuItems:function(e){var s=t.getAncestorByClass(e,"tabBody"),i=s.repObject.getSearchOptions();return i.push("-"),i.push({label:n.caseSensitive,checked:o.getBooleanCookie(u.caseSensitiveCookieName),command:t.bindFixed(this.onOption,this,u.caseSensitiveCookieName)}),i},onOption:function(e){o.toggleCookie(e),t.getElementByClass(document.documentElement,"searchInput").removeAttribute("status")}}),u.Resizer=r({initialize:function(e,n){this.searchInput=e,this.tracker=new a.Tracker(n,{onDragStart:t.bind(this.onDragStart,this),onDragOver:t.bind(this.onDragOver,this),onDrop:t.bind(this.onDrop,this)})},onDragStart:function(e){t.getBody(this.searchInput.ownerDocument).setAttribute("vResizing","true"),this.startWidth=this.searchInput.clientWidth-20},onDragOver:function(e,n){var s=this.startWidth-e.x;s>t.getAncestorByClass(this.searchInput,"toolbar").clientWidth-40||(this.searchInput.style.width=s+"px")},onDrop:function(e){t.getBody(this.searchInput.ownerDocument).removeAttribute("vResizing")}}),u});
//# sourceMappingURL=search.js.map