/* See license.txt for terms of usage */


define(["../domplate/domplate","../domplate/tabView","../core/lib","../core/cookies","../core/trace","i18n!../nls/homeTab","text!./homeTab.html","../preview/harModel"],function(e,n,t,o,i,a,r,d){function l(){}var c=e.DIV;return l.prototype=t.extend(n.Tab.prototype,{id:"Home",label:a.homeTabLabel,bodyTag:c({class:"homeBody"}),onUpdateBody:function(e,n){n=this.bodyTag.replace({},n),n.innerHTML=r.replace("@HAR_SPEC_URL@",e.harSpecURL,"g"),$("#appendPreview").click(t.bindFixed(this.onAppendPreview,this)),$(".linkAbout").click(t.bind(this.onAbout,this));var i=$("#content");i.bind("dragenter",t.bind(t.cancelEvent,t)),i.bind("dragover",t.bind(t.cancelEvent,t)),i.bind("drop",t.bind(this.onDrop,this)),this.validateNode=$("#validate");var a=o.getCookie("validate");a&&this.validateNode.prop("checked","false"!==a),this.validateNode.change(t.bind(this.onValidationChange,this)),$(".example").click(t.bind(this.onLoadExample,this))},onAppendPreview:function(e){e||(e=$("#sourceEditor").val()),e&&this.tabView.appendPreview(e)},onAbout:function(){this.tabView.selectTabByName("About")},onValidationChange:function(){var e=this.validateNode.prop("checked");o.setCookie("validate",e)},onLoadExample:function(e){var n=t.fixEvent(e),i=n.target.getAttribute("har"),a=document.location.href,r=a.indexOf("?");document.location=a.substr(0,r)+"?har="+i,o.setCookie("timeline",!0),o.setCookie("stats",!0)},onDrop:function(e){var n=t.fixEvent(e);t.cancelEvent(n);try{this.handleDrop(e.originalEvent.dataTransfer)}catch(e){i.exception("HomeTab.onDrop EXCEPTION",e)}},handleDrop:function(e){function n(e){alert("File drag and drop not supported for this browser ["+e+"]")}function o(e,t){if(!((t=t||0)>=e.length)){var i=d.getFileReader(e[t],function(n){n&&d.onAppendPreview(n),o(e,t+1)});if(!i)return n("FileReader API not present");i()}}if(!e)return!1;var i=e.files;if(!i)return n("dataTransfer.files not present");var a=[].slice.call(i),r=a.filter(function(e){return"har"===t.getFileExtension(e.name).toLowerCase()});r.sort(function(e,n){return e.name.localeCompare(n.name)});var d=this;o(r)},getFileReader:function(e,n){return"undefined"!=typeof FileReader?function(){var t=new FileReader;t.onloadend=function(){n(t.result)},t.readAsText(e)}:null},loadInProgress:function(e,n){$("#sourceEditor").val(e?n||a.loadingHar:"")}}),l});
//# sourceMappingURL=homeTab.js.map