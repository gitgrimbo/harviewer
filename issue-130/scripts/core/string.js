/* See license.txt for terms of usage */

define(["./array","core/trace"],function(r,e){var t={};return t.formatSize=function(r){var e=1;if(e=e>2?2:e,-1===(e=e<-1?-1:e))return r+" B";var t=Math.pow(10,e);return-1===r||void 0===r?"?":0===r?"0":r<1024?r+" B":r<1048576?Math.round(r/1024*t)/t+" KB":Math.round(r/1048576*t)/t+" MB"},t.formatTime=function(r){return-1===r?"-":r<1e3?r+"ms":r<6e4?Math.ceil(r/10)/100+"s":Math.ceil(r/6e4*100)/100+"m"},t.formatNumber=function(r){r=String(r);for(var e=r.split("."),t=e[0],n=e.length>1?"."+e[1]:"",a=/(\d+)(\d{3})/;a.test(t);)t=t.replace(a,"$1 $2");return t+n},t.formatString=function(e){var t=r.cloneArray(arguments);e=t.shift();for(var n=0;n<t.length;n++){var a=t[n].toString();e=e.replace("%S",a)}return e},t.startsWith=function(r,e,t){return t=t||0,r.indexOf(e,t)===t},t.trim=function(r){return r.replace(/^\s*|\s*$/g,"")},t.wrapText=function(r,e){for(var n=/[^A-Za-z_$0-9'"-]/,a=[],i=t.splitLines(r),s=0;s<i.length;++s){for(var u=i[s];u.length>100;){var c=n.exec(u.substr(100,100)),p=100+(c?c.index:0),o=u.substr(0,p);u=u.substr(p),e||a.push("<pre>"),a.push(e?o:t.escapeHTML(o)),e||a.push("</pre>")}e||a.push("<pre>"),a.push(e?u:t.escapeHTML(u)),e||a.push("</pre>")}return a.join(e?"\n":"")},t.insertWrappedText=function(r,e,n){e.innerHTML="<pre>"+t.wrapText(r,n)+"</pre>"},t.splitLines=function(r){var e=/\r\n|\r|\n/;return r?r.split?r.split(e):String(r).split(e):[]},t.escapeHTML=function(r){function e(r){switch(r){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case"'":return"&#39;";case'"':return"&quot;"}return"?"}return String(r).replace(/[<>&"']/g,e)},t.cropString=function(r,e){r=String(r);var n=e?e/2:50;return r.length>e?t.escapeNewLines(r.substr(0,n)+"..."+r.substr(r.length-n)):t.escapeNewLines(r)},t.escapeNewLines=function(r){return r.replace(/\r/g,"\\r").replace(/\n/g,"\\n")},t});